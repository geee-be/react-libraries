# @geee-be/react-twui - Copilot Instructions

## Package Overview
A comprehensive React UI component library built on Tailwind CSS v4 and Radix UI primitives. Provides a complete set of accessible, customizable components for modern React applications with a focus on developer experience, accessibility, and performance. Components follow the shadcn/ui design patterns and are built on Radix UI's accessible primitives.

## Package Structure
```
src/
├── components/           # UI Components (35+ components)
│   ├── index.ts         # Main component exports
│   ├── types.ts         # Shared component types
│   ├── Alert/           # Alert component with variants
│   ├── AspectRatio/     # Aspect ratio container
│   ├── Async/           # Async loading wrapper component
│   ├── Avatar/          # User avatar with fallbacks
│   ├── Breadcrumb/      # Navigation breadcrumbs
│   ├── Button/          # Button with multiple variants
│   ├── Calendar/        # Full calendar component
│   ├── Card/            # Card composition components
│   ├── Carousel/        # Image/content carousel
│   ├── Checkbox/        # Checkbox form control
│   ├── Collapsible/     # Collapsible content areas
│   ├── Combobox/        # Combination input/dropdown
│   ├── Command/         # Command palette
│   ├── Cropper/         # Image cropping component
│   ├── DatePicker/      # Date selection with calendar
│   ├── Dialog/          # Modal dialogs
│   ├── Drawer/          # Slide-out panels
│   ├── DropdownMenu/    # Dropdown menu component
│   ├── FormControl/     # Form field wrapper
│   ├── Input/           # Text input controls
│   ├── InputFile/       # File upload input
│   ├── InputOtp/        # One-time password input
│   ├── Join/            # Component joining utility
│   ├── Label/           # Form labels
│   ├── Pagination/      # Page navigation
│   ├── Popover/         # Floating content
│   ├── ScrollArea/      # Custom scrollable areas
│   ├── Select/          # Dropdown selections
│   ├── Separator/       # Visual dividers
│   ├── Sheet/           # Side panels and overlays
│   ├── ShortcutKey/     # Keyboard shortcut display
│   ├── Sidebar/         # Collapsible sidebar navigation
│   ├── Skeleton/        # Loading placeholders
│   ├── Spinner/         # Loading indicators
│   ├── Toast/           # Toast notifications
│   ├── Tooltip/         # Contextual information
│   ├── WithIcon/        # Icon wrapper utility
│   ├── YearPicker/      # Year selection component
│   └── icons/           # Icon components
├── helpers/             # Utility functions
│   ├── style.js         # Styling utilities and variants
│   └── utils.js         # General utility functions
└── index.ts             # Package main export
css/
├── default.css          # Base styles and CSS reset
├── theme.css            # Theme variables and color system
├── twui.css             # Component-specific styles
├── calculations.css     # Computed values and calculations
├── like.css             # Additional utility classes
└── reset.css            # CSS reset utilities
```

## Key Dependencies
- **Tailwind CSS v4**: Latest alpha with modern CSS features
- **Radix UI**: Unstyled, accessible component primitives
- **CVA (Class Variance Authority)**: For component variant management
- **Tailwind Merge**: For intelligent CSS class merging
- **React Hook Form**: Form handling and validation
- **Date-fns**: Date manipulation utilities

## Component Architecture
Components are organized by functionality and follow consistent patterns inspired by shadcn/ui:

### Core Component Categories
- **Layout**: Card, AspectRatio, Separator, Skeleton, Sheet
- **Navigation**: Breadcrumb, Pagination, Sidebar, DropdownMenu
- **Form Controls**: Input, Checkbox, Select, DatePicker, InputFile, InputOtp, FormControl, Label
- **Feedback**: Alert, Toast, Tooltip, Spinner
- **Overlays**: Dialog, Drawer, Popover, Sheet, Collapsible
- **Data Display**: Avatar, Calendar, Carousel, Command, ScrollArea
- **Interactive**: Button, Toggle, Switch, Tabs (from external packages)
- **Utility**: Async, Cropper, Join, ShortcutKey, WithIcon, YearPicker, icons
- **Specialized**: Combobox (combination input/dropdown)

### Component Structure Pattern
```
ComponentName/
├── index.ts              # Main export and re-exports
├── component.tsx         # Component implementation
├── component.stories.tsx # Storybook stories (optional)
└── types.ts             # TypeScript definitions (if complex)
```

### Composition Pattern
Components follow compound component patterns where applicable:
```typescript
<Card>
  <Card.Header>
    <Card.Title>Title</Card.Title>
    <Card.Description>Description</Card.Description>
  </Card.Header>
  <Card.Content>Content</Card.Content>
  <Card.Footer>Footer</Card.Footer>
</Card>
```

### Compound Component Export Pattern
For components with multiple related sub-components, use the compound component pattern to provide an intuitive API while maintaining backward compatibility:

```typescript
// index.ts - Dual export pattern (compound + original forms)
export type { CardProps } from './Card.js';

import { Card as CardComponent } from './Card.js';
import { CardContent as CardContentComponent } from './CardContent';
import { CardFooter as CardFooterComponent } from './CardFooter';
import { CardHeader as CardHeaderComponent } from './CardHeader';

type CardCompound = typeof CardComponent & {
  Content: typeof CardContentComponent;
  Footer: typeof CardFooterComponent;
  Header: typeof CardHeaderComponent;
};

export const Card: CardCompound = Object.assign(CardComponent, {
  Content: CardContentComponent,
  Footer: CardFooterComponent,
  Header: CardHeaderComponent,
});

// Export original form components for backward compatibility and flexibility
export {
  CardContentComponent as CardContent,
  CardFooterComponent as CardFooter,
  CardHeaderComponent as CardHeader,
};
```

This dual export pattern provides:
- **Compound usage**: `Card.Header`, `Card.Content`, `Card.Footer` (recommended for new code)
- **Original form**: `CardHeader`, `CardContent`, `CardFooter` (backward compatibility and individual imports)
- **Maximum flexibility**: Both usage patterns supported simultaneously

## Styling System
- **CSS Custom Properties**: Defined in `css/` directory for theming
- **Tailwind Utilities**: Primary styling approach
- **Component Variants**: Managed with CVA for consistent API
- **Dark Mode**: Built-in support with CSS custom properties
- **Responsive Design**: Mobile-first approach with Tailwind breakpoints

### CSS Files
- `css/default.css`: Base styles and CSS custom properties
- `css/theme.css`: Color system and theme variables
- `css/twui.css`: Component-specific styles
- `css/reset.css`: CSS reset utilities
- `css/calculations.css`: Computed values and calculations

## Development Patterns

### Component Implementation
- Use `forwardRef` for all interactive components
- Implement component variants with CVA
- Support both controlled and uncontrolled patterns
- Include proper TypeScript definitions
- Follow Radix UI patterns for accessibility

### Styling Guidelines
- Use semantic color tokens (`primary`, `secondary`, `info`, `warning`, `error`, `danger`)
- Some colors have `*-fg` variants for contrast foreground colors
- Other semantic tokens: `background`, `foreground`, `input`, `input-fg`, `input-border`
- Implement size variants (`sm`, `md`, `lg`, `xl`)
- Support visual variants (`default`, `outline`, `ghost`, `link`)
- Use consistent spacing scale from Tailwind
- Follow mobile-first responsive design principles

### Accessibility Implementation
- All interactive components use Radix UI primitives as foundation
- Implement proper ARIA labels, descriptions, and roles
- Support keyboard navigation patterns
- Provide focus management and visual indicators
- Test with screen readers during development
- Follow WCAG 2.1 AA guidelines

### Performance Optimization
- Use React.forwardRef for all interactive components
- Implement proper memoization with React.memo where beneficial
- Optimize re-renders with useCallback and useMemo
- Ensure components are tree-shakeable
- Minimize bundle size impact through selective imports

### TypeScript Patterns
- Export component props interfaces
- Use generic types for flexible APIs
- Implement proper event handler types
- Support ref forwarding with proper typing

## Build Configuration
- **Dual Output**: ESM and CommonJS builds via tsup
- **External Dependencies**: React marked as external
- **Tree Shaking**: Optimized for minimal bundle size
- **Type Definitions**: Generated for both CJS and ESM

## Testing & Development
- **Storybook**: Component development and documentation
- **Type Safety**: Strict TypeScript compilation
- **Accessibility**: Built on Radix UI primitives
- **Performance**: Optimized for minimal re-renders

## Usage Examples
```typescript
import { Button, Card, Input, Alert } from '@geee-be/react-twui';
// or import individual components in original form
import { Button, CardHeader, CardContent, CardFooter, Input, Alert } from '@geee-be/react-twui';

// Compound usage (recommended for new code)
<Button variant="outline" size="lg">Click me</Button>

// Layout components with compound composition
<Card className="w-96">
  <Card.Header>
    <Card.Title>User Profile</Card.Title>
    <Card.Description>Manage your account settings</Card.Description>
  </Card.Header>
  <Card.Content className="space-y-4">
    <Input placeholder="Full name" />
    <Button className="w-full">Save Changes</Button>
  </Card.Content>
</Card>

// Alternative: Original form usage (backward compatibility)
<Card className="w-96">
  <CardHeader>
    <CardTitle>User Profile</CardTitle>
    <CardDescription>Manage your account settings</CardDescription>
  </CardHeader>
  <CardContent className="space-y-4">
    <Input placeholder="Full name" />
    <Button className="w-full">Save Changes</Button>
  </CardContent>
</Card>

// Mixed usage patterns are also supported
<Card className="w-96">
  <Card.Header>
    <CardTitle>Mixed Pattern</CardTitle>
  </Card.Header>
  <CardContent>
    <Button>Save</Button>
  </CardContent>
</Card>

// Complex component with variants and state
<Dialog>
  <Dialog.Trigger asChild>
    <Button variant="outline">Open Dialog</Button>
  </Dialog.Trigger>
  <Dialog.Content>
    <Dialog.Header>
      <Dialog.Title>Confirm Action</Dialog.Title>
      <Dialog.Description>
        This action cannot be undone.
      </Dialog.Description>
    </Dialog.Header>
    <Dialog.Footer>
      <Button variant="outline">Cancel</Button>
      <Button variant="destructive">Delete</Button>
    </Dialog.Footer>
  </Dialog.Content>
</Dialog>
```

## Theme Customization
```css
/* Override CSS custom properties for theming */
:root {
  --primary: 220 100% 50%;
  --primary-fg: 0 0% 100%;
  --secondary: 220 20% 95%;
  --secondary-fg: 220 20% 10%;
  --destructive: 0 100% 60%;
  --destructive-fg: 0 0% 100%;
}

[data-theme='dark'] {
  --primary: 220 100% 60%;
  --background: 0 0% 5%;
  --foreground: 0 0% 95%;
}
```

## Integration Patterns
```typescript
// With React Hook Form
import { useForm } from 'react-hook-form';
import { Button, Input, FormControl } from '@geee-be/react-twui';

const { register, formState: { errors } } = useForm();

<FormControl error={errors.email?.message}>
  <Input {...register('email', { required: 'Email is required' })} />
</FormControl>

// With Storybook
export default {
  title: 'Components/Button',
  component: Button,
  parameters: { docs: { description: { component: 'Primary button component' } } }
};
```

## Best Practices

### Component Development
- Always use semantic HTML elements as base
- Build on Radix UI primitives for accessibility
- Implement keyboard navigation for interactive components
- Provide proper ARIA labels and descriptions
- Test components with screen readers
- Follow Radix UI composition patterns
- Use consistent naming conventions for props and variants
- Support both controlled and uncontrolled patterns where applicable
- **Compound Components**: Use the compound component pattern for components with multiple related sub-components (like Card, Dialog, Alert) to provide an intuitive API while maintaining individual component accessibility

#### When to Use Compound Component Pattern
Use the compound component pattern when:
- A component has multiple related sub-components that are commonly used together
- Sub-components have semantic relationships (e.g., Header, Content, Footer)
- You want to provide both compound usage (`Component.SubComponent`) and individual access
- The component follows a clear hierarchical structure
- Examples: Card, Dialog, Breadcrumb, Alert with description/title, Sheet, Drawer

#### Components Suitable for Conversion
Consider converting these components to compound pattern:
- `Dialog` → `Dialog.Trigger`, `Dialog.Content`, `Dialog.Header`, `Dialog.Footer`, etc.
- `Breadcrumb` → `Breadcrumb.List`, `Breadcrumb.Item`, `Breadcrumb.Link`, etc.
- `Alert` → `Alert.Title`, `Alert.Description` (if separate components exist)
- `Sheet` → `Sheet.Trigger`, `Sheet.Content`, `Sheet.Header`, etc.
- `Drawer` → `Drawer.Trigger`, `Drawer.Content`, `Drawer.Header`, etc.

### Styling Best Practices
- Use CSS custom properties for themeable values
- Implement responsive design with mobile-first approach
- Follow consistent spacing and sizing scales
- Use semantic color tokens instead of raw color values
- Ensure sufficient color contrast for accessibility
- Support dark mode through CSS custom property switching

### Performance Guidelines
- Use React.forwardRef for DOM element access
- Implement proper component memoization when needed
- Avoid unnecessary re-renders through proper dependency arrays
- Use CVA for variant management to reduce bundle size
- Ensure components are tree-shakeable through proper exports

### Testing Strategies
- Test all component variants and states in Storybook
- Verify accessibility with automated tools and manual testing
- Test keyboard navigation and focus management
- Validate responsive behavior across breakpoints
- Check component composition patterns work correctly

## Troubleshooting

### Common Issues
- **Styling conflicts**: Ensure Tailwind CSS is properly configured and twui.css is imported
- **Accessibility warnings**: Check that interactive elements have proper ARIA attributes
- **TypeScript errors**: Verify component props match interface definitions
- **Hydration issues**: Ensure components work with SSR frameworks
- **Bundle size**: Use selective imports and check for duplicate dependencies

### Development Tips
- Use Storybook for isolated component development
- Test components in different themes (light/dark)
- Verify responsive behavior with browser dev tools
- Use React DevTools to check component re-renders
- Test with keyboard-only navigation regularly

## Integration with shadcn/ui
This library is heavily inspired by and compatible with shadcn/ui patterns:
- Similar component APIs and naming conventions
- Compatible theming system using CSS custom properties
- Same Radix UI foundation for accessibility
- Equivalent variant management patterns
- Credit to @shadcn for the excellent design patterns and foundation
