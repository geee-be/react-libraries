# Workspace Development Guide - Copilot Instructions

## Monorepo Management

### Package Dependencies
- `@geee-be/react-twui` depends on `@geee-be/react-utils` (workspace dependency)
- Use `workspace:*` protocol for internal package dependencies
- External dependencies should be added to the appropriate package, not the root

### Development Commands
```bash
# Install all dependencies
pnpm install

# Build all packages (parallel)
pnpm build

# Start development mode (watch all packages)
pnpm start:dev

# Lint all packages
pnpm lint

# Lint and fix with Biome
pnpm lint:biome:fix
```

### Creating Changesets
```bash
# Interactive changeset creation
pnpm changes

# Manual changeset creation
pnpm changeset
```

## Tailwind CSS Configuration

### Current Setup
- Using Tailwind CSS v4 (alpha) with modern CSS features
- PostCSS integration with `@tailwindcss/postcss`
- Custom CSS properties for theming in `react-twui/css/` directory
- Tailwind config in `react-twui/tailwind.config.js`

### CSS Architecture
1. **Base Styles**: `css/reset.css` and `css/default.css`
2. **Theme Variables**: `css/theme.css` with CSS custom properties
3. **Component Styles**: `css/twui.css` for component-specific styles
4. **Calculations**: `css/calculations.css` for computed values
5. **Additional Utilities**: `css/like.css` for additional utility classes

### Color System
- Uses semantic color tokens (`primary`, `secondary`, `info`, `warning`, `error`, `danger`, etc.)
- Some of the above have `*-fg` options for contrast foreground colors
- Other token colors include `background`, `foreground`, `input`, `input-fg`, `input-border`
- CSS custom properties enable dynamic theming
- Dark mode support through property value switching
- Consistent opacity modifiers for color variations

### Integration Setup
```css
/* Required CSS imports */
@import 'tailwindcss';
@import '@geee-be/react-twui/css/twui.css';
```

## TypeScript Configuration

### Compilation Targets
- **react-twui**: Dual ESM/CJS builds with tsup
- **react-utils**: Single ESM build with tsc
- Type definitions generated for both output formats

### Shared Configuration
- Root `tsconfig.json` excludes `dist/` directories
- Each package has its own TypeScript configuration
- Strict mode enabled across all packages
- Unused exports detection enabled

## Storybook Integration

### Development
- Each package can run its own Storybook instance
- Stories co-located with components (`.stories.tsx`)
- Dark mode addon configured
- Tailwind CSS integration in Storybook

### Component Documentation
- Use Storybook for visual testing and documentation
- Include all component variants in stories
- Document prop interfaces and usage examples
- Test accessibility features in Storybook

## Code Quality Standards

### Biome Configuration
- Single quotes for JavaScript/TypeScript
- 2-space indentation
- Automatic import organization
- CSS formatting with consistent spacing
- Lint rules: recommended + custom overrides

### TypeScript Standards
- Strict mode enabled
- Proper type exports for all public APIs
- Generic types for flexible component APIs
- Consistent naming conventions
- Comprehensive error handling

## Build and Release Process

### Build Configuration
- **tsup**: Modern TypeScript bundler for optimized builds
- **Concurrent builds**: ESM and CJS built in parallel
- **External dependencies**: React marked as external
- **Tree shaking**: Optimized for minimal bundle impact

### Publishing Workflow
1. Create changesets for modifications
2. Version bumps handled automatically
3. Changelog generation from changesets
4. Independent package versioning
5. NPM publishing (when configured)

## Development Guidelines

### Component Development
1. Start with Radix UI primitive (if applicable)
2. Add Tailwind styling with semantic classes
3. Implement variants using CVA
4. Add TypeScript definitions
5. Create Storybook stories
6. Test accessibility features
7. Document usage patterns

### Hook Development
1. Follow React hooks conventions
2. Support SSR/client-side differences
3. Implement proper cleanup
4. Add TypeScript definitions
5. Create usage examples
6. Consider performance implications

### File Organization
- Keep related files co-located
- Use consistent naming conventions
- Export from index files for clean APIs
- Separate types into dedicated files when complex
- Group utilities by functionality

## Common Patterns

### Component Composition
```typescript
// Compound component pattern
<Card>
  <Card.Header>
    <Card.Title>Title</Card.Title>
  </Card.Header>
  <Card.Content>Content</Card.Content>
</Card>
```

### Ref Forwarding
```typescript
const Component = forwardRef<HTMLElement, Props>((props, ref) => {
  return <element ref={ref} {...props} />;
});
```

### Variant Management
```typescript
const variants = cva('base-classes', {
  variants: {
    variant: {
      default: 'default-classes',
      outline: 'outline-classes',
    },
    size: {
      sm: 'small-classes',
      lg: 'large-classes',
    },
  },
});
```

## Troubleshooting

### Common Issues
- **Build failures**: Check TypeScript errors and dependency versions
- **Styling issues**: Verify Tailwind configuration and CSS imports
- **Import errors**: Ensure proper package exports configuration
- **Type errors**: Check TypeScript configuration and version compatibility

### Development Tips
- Use workspace commands to run across all packages
- Check individual package scripts for specific tasks
- Monitor build output for optimization opportunities
- Use Storybook for isolated component development
